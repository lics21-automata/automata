<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Preliminaries</title>
</head>


<body>
<div class="head">
<h1>Theory Preliminaries</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command">theory</span></span> Preliminaries
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="Computation.html">Computation</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">context</span></span> NFT
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="quoted"><span class="quoted">"<span class="free">bvT'</span> <span class="main">⟷</span> <span class="main">(</span><span class="main">∃</span><span class="bound">t</span><span class="main">.</span> <span class="main">∀</span><span class="bound">q1</span> <span class="bound">q2</span> <span class="bound">f1</span> <span class="bound">f2</span> <span class="bound">a</span> <span class="bound">b1</span> <span class="bound">b2</span> <span class="bound">u</span> <span class="bound">v1</span> <span class="bound">v2</span> <span class="bound">w1</span> <span class="bound">w2</span><span class="main">.</span>
  <span class="bound">q1</span> <span class="main">∈</span> <span class="free">Q</span> <span class="main">∧</span> <span class="bound">q2</span> <span class="main">∈</span> <span class="free">Q</span> <span class="main">∧</span> <span class="free">accept</span> <span class="bound">f1</span> <span class="main">∧</span> <span class="free">accept</span> <span class="bound">f2</span> <span class="main">∧</span>
  <span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="bound">a</span><span class="main">,</span> <span class="bound">u</span> <span class="main">@</span> <span class="bound">v1</span><span class="main">)</span> <span class="bound">q1</span> <span class="main">∧</span> <span class="bound">q1</span> <span class="main">↝</span><span class="main">(</span><span class="bound">b1</span><span class="main">,</span> <span class="bound">w1</span><span class="main">)</span> <span class="bound">f1</span> <span class="main">∧</span>
  <span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="bound">a</span><span class="main">,</span> <span class="bound">u</span> <span class="main">@</span> <span class="bound">v2</span><span class="main">)</span> <span class="bound">q2</span> <span class="main">∧</span> <span class="bound">q2</span> <span class="main">↝</span><span class="main">(</span><span class="bound">b2</span><span class="main">,</span> <span class="bound">w2</span><span class="main">)</span> <span class="bound">f2</span> <span class="main">⟶</span> lcp_dist <span class="bound">v1</span> <span class="bound">v2</span> <span class="main">≤</span> <span class="bound">t</span><span class="main">)</span>"</span></span>

<span class="comment1">(* Lemma 10 *)</span>

<span class="keyword1"><span class="command">lemma</span></span> bvT_alt<span class="main">:</span> <span class="quoted"><span class="quoted">"bvT <span class="main">=</span> bvT'"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> iffI<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"bvT"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> t_def<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">q1</span> <span class="bound">q2</span> <span class="bound">f1</span> <span class="bound">f2</span> <span class="bound">a</span> <span class="bound">b1</span> <span class="bound">b2</span> <span class="bound">u</span> <span class="bound">v1</span> <span class="bound">v2</span> <span class="bound">w1</span> <span class="bound">w2</span><span class="main">.</span> <span class="bound">q1</span> <span class="main">∈</span> <span class="free">Q</span> <span class="main">⟹</span> <span class="bound">q2</span> <span class="main">∈</span> <span class="free">Q</span> <span class="main">⟹</span> <span class="free">accept</span> <span class="bound">f1</span> <span class="main">⟹</span> <span class="free">accept</span> <span class="bound">f2</span> <span class="main">⟹</span>
      <span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="bound">a</span><span class="main">,</span> <span class="bound">u</span> <span class="main">@</span> <span class="bound">v1</span><span class="main">)</span> <span class="bound">q1</span> <span class="main">⟹</span> <span class="bound">q1</span> <span class="main">↝</span><span class="main">(</span><span class="bound">b1</span><span class="main">,</span> <span class="bound">w1</span><span class="main">)</span> <span class="bound">f1</span> <span class="main">⟹</span>
      <span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="bound">a</span><span class="main">,</span> <span class="bound">u</span> <span class="main">@</span> <span class="bound">v2</span><span class="main">)</span> <span class="bound">q2</span> <span class="main">⟹</span> <span class="bound">q2</span> <span class="main">↝</span><span class="main">(</span><span class="bound">b2</span><span class="main">,</span> <span class="bound">w2</span><span class="main">)</span> <span class="bound">f2</span> <span class="main">⟹</span>
      length <span class="bound">b1</span> <span class="main">+</span> length <span class="bound">b2</span> <span class="main">≤</span> sg <span class="main">+</span> sg <span class="main">⟹</span> lcp_dist <span class="main">(</span><span class="bound">v1</span> <span class="main">@</span> <span class="bound">w1</span><span class="main">)</span> <span class="main">(</span><span class="bound">v2</span> <span class="main">@</span> <span class="bound">w2</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">t</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> bvT_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">k</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">q1</span> <span class="skolem">q2</span> <span class="skolem">f1</span> <span class="skolem">f2</span> <span class="skolem">a</span> <span class="skolem">b1</span> <span class="skolem">b2</span> <span class="skolem">u</span> <span class="skolem">v1</span> <span class="skolem">v2</span> <span class="skolem">w1</span> <span class="skolem">w2</span>
    <span class="keyword3"><span class="command">assume</span></span> assms<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">accept</span> <span class="skolem">f1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">accept</span> <span class="skolem">f2</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q1</span> <span class="main">∈</span> <span class="free">Q</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q2</span> <span class="main">∈</span> <span class="free">Q</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">a</span><span class="main">,</span> <span class="skolem">u</span> <span class="main">@</span> <span class="skolem">v1</span><span class="main">)</span> <span class="skolem">q1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q1</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">b1</span><span class="main">,</span> <span class="skolem">w1</span><span class="main">)</span> <span class="skolem">f1</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">a</span><span class="main">,</span> <span class="skolem">u</span> <span class="main">@</span> <span class="skolem">v2</span><span class="main">)</span> <span class="skolem">q2</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q2</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">b2</span><span class="main">,</span> <span class="skolem">w2</span><span class="main">)</span> <span class="skolem">f2</span>"</span></span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b1'</span></span> <span class="skolem"><span class="skolem">w1'</span></span> <span class="skolem"><span class="skolem">f1'</span></span> <span class="keyword2"><span class="keyword">where</span></span> sg1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q1</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">b1'</span><span class="main">,</span> <span class="skolem">w1'</span><span class="main">)</span> <span class="skolem">f1'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">accept</span> <span class="skolem">f1'</span>"</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">b1'</span> <span class="main">≤</span> sg"</span></span>
      <span class="keyword1"><span class="command">using</span></span> active_Nil_dest_sg<span class="main">[</span><span class="operator">OF</span> _ assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span> assms<span class="main">(</span>1<span class="main">,</span>6<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> active_def<span class="main">)</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b2'</span></span> <span class="skolem"><span class="skolem">w2'</span></span> <span class="skolem"><span class="skolem">f2'</span></span> <span class="keyword2"><span class="keyword">where</span></span> sg2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q2</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">b2'</span><span class="main">,</span> <span class="skolem">w2'</span><span class="main">)</span> <span class="skolem">f2'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">accept</span> <span class="skolem">f2'</span>"</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">b2'</span> <span class="main">≤</span> sg"</span></span>
      <span class="keyword1"><span class="command">using</span></span> active_Nil_dest_sg<span class="main">[</span><span class="operator">OF</span> _ assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> assms<span class="main">(</span>2<span class="main">,</span>8<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> active_def<span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lcp_dist <span class="main">(</span><span class="skolem">v1</span> <span class="main">@</span> <span class="skolem">w1'</span><span class="main">)</span> <span class="main">(</span><span class="skolem">v2</span> <span class="main">@</span> <span class="skolem">w2'</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">t</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> t_def<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">,</span></span>4<span class="main"><span class="main">)</span></span> sg1<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> sg2<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> sg1<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>7<span class="main"><span class="main">)</span></span> sg2<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span> sg1<span class="main">(</span>3<span class="main">)</span> sg2<span class="main">(</span>3<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lcp_dist <span class="skolem">v1</span> <span class="skolem">v2</span> <span class="main">≤</span> <span class="skolem">t</span> <span class="main">+</span> length <span class="skolem">w1'</span> <span class="main">+</span> length <span class="skolem">w2'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> lcp_dist_le_app_sum<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">v1</span></span> <span class="quoted"><span class="skolem">v2</span></span> <span class="quoted"><span class="skolem">w1'</span></span> <span class="quoted"><span class="skolem">w2'</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">≤</span> <span class="skolem">t</span> <span class="main">+</span> length <span class="skolem">b1'</span> <span class="main">*</span> output_speed <span class="main">+</span> length <span class="skolem">b2'</span> <span class="main">*</span> output_speed"</span></span>
      <span class="keyword1"><span class="command">using</span></span> output_speed_computation<span class="main">[</span><span class="operator">OF</span> sg1<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span>
        output_speed_computation<span class="main">[</span><span class="operator">OF</span> sg2<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">≤</span> <span class="skolem">t</span> <span class="main">+</span> sg <span class="main">*</span> output_speed <span class="main">+</span> sg <span class="main">*</span> output_speed"</span></span>
      <span class="keyword1"><span class="command">using</span></span> sg1<span class="main">(</span>3<span class="main">)</span> sg2<span class="main">(</span>3<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> add_mono<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lcp_dist <span class="skolem">v1</span> <span class="skolem">v2</span> <span class="main">≤</span> <span class="skolem">t</span> <span class="main">+</span> sg <span class="main">*</span> output_speed <span class="main">+</span> sg <span class="main">*</span> output_speed"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"bvT'"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> bvT'_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"bvT'"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> t_def<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">q1</span> <span class="bound">q2</span> <span class="bound">f1</span> <span class="bound">f2</span> <span class="bound">a</span> <span class="bound">b1</span> <span class="bound">b2</span> <span class="bound">u</span> <span class="bound">v1</span> <span class="bound">v2</span> <span class="bound">w1</span> <span class="bound">w2</span><span class="main">.</span> <span class="bound">q1</span> <span class="main">∈</span> <span class="free">Q</span> <span class="main">⟹</span> <span class="bound">q2</span> <span class="main">∈</span> <span class="free">Q</span> <span class="main">⟹</span> <span class="free">accept</span> <span class="bound">f1</span> <span class="main">⟹</span> <span class="free">accept</span> <span class="bound">f2</span> <span class="main">⟹</span>
      <span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="bound">a</span><span class="main">,</span> <span class="bound">u</span> <span class="main">@</span> <span class="bound">v1</span><span class="main">)</span> <span class="bound">q1</span> <span class="main">⟹</span> <span class="bound">q1</span> <span class="main">↝</span><span class="main">(</span><span class="bound">b1</span><span class="main">,</span> <span class="bound">w1</span><span class="main">)</span> <span class="bound">f1</span> <span class="main">⟹</span>
      <span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="bound">a</span><span class="main">,</span> <span class="bound">u</span> <span class="main">@</span> <span class="bound">v2</span><span class="main">)</span> <span class="bound">q2</span> <span class="main">⟹</span> <span class="bound">q2</span> <span class="main">↝</span><span class="main">(</span><span class="bound">b2</span><span class="main">,</span> <span class="bound">w2</span><span class="main">)</span> <span class="bound">f2</span> <span class="main">⟹</span> lcp_dist <span class="bound">v1</span> <span class="bound">v2</span> <span class="main">≤</span> <span class="skolem">t</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> bvT'_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">k</span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">q1</span> <span class="skolem">q2</span> <span class="skolem">f1</span> <span class="skolem">f2</span> <span class="skolem">a</span> <span class="skolem">b1</span> <span class="skolem">b2</span> <span class="skolem">u</span> <span class="skolem">v1</span> <span class="skolem">v2</span> <span class="skolem">w1</span> <span class="skolem">w2</span>
    <span class="keyword3"><span class="command">assume</span></span> assms<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q1</span> <span class="main">∈</span> <span class="free">Q</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q2</span> <span class="main">∈</span> <span class="free">Q</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">accept</span> <span class="skolem">f1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">accept</span> <span class="skolem">f2</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">a</span><span class="main">,</span> <span class="skolem">u</span> <span class="main">@</span> <span class="skolem">v1</span><span class="main">)</span> <span class="skolem">q1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q1</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">b1</span><span class="main">,</span> <span class="skolem">w1</span><span class="main">)</span> <span class="skolem">f1</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">a</span><span class="main">,</span> <span class="skolem">u</span> <span class="main">@</span> <span class="skolem">v2</span><span class="main">)</span> <span class="skolem">q2</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q2</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">b2</span><span class="main">,</span> <span class="skolem">w2</span><span class="main">)</span> <span class="skolem">f2</span>"</span></span>
      <span class="quoted"><span class="quoted">"length <span class="skolem">b1</span> <span class="main">+</span> length <span class="skolem">b2</span> <span class="main">≤</span> <span class="skolem">k</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lcp_dist <span class="main">(</span><span class="skolem">v1</span> <span class="main">@</span> <span class="skolem">w1</span><span class="main">)</span> <span class="main">(</span><span class="skolem">v2</span> <span class="main">@</span> <span class="skolem">w2</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">t</span> <span class="main">+</span> length <span class="skolem">b1</span> <span class="main">*</span> output_speed <span class="main">+</span> length <span class="skolem">b2</span> <span class="main">*</span> output_speed"</span></span>
      <span class="keyword1"><span class="command">using</span></span> lcp_dist_app_le_sum<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="skolem">v1</span></span> <span class="quoted"><span class="skolem">w1</span></span> <span class="quoted"><span class="skolem">v2</span></span> <span class="quoted"><span class="skolem">w2</span></span><span class="main">]</span> t_def<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">,</span></span>3<span class="main"><span class="main">,</span></span>4<span class="main"><span class="main">,</span></span>5<span class="main"><span class="main">,</span></span>6<span class="main"><span class="main">,</span></span>7<span class="main"><span class="main">,</span></span>8<span class="main"><span class="main">)</span></span><span class="main">]</span>
        output_speed_computation<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">,</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span> output_speed_computation<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>8<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">unfolding</span></span> lcp_dist_same_pref
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">≤</span> <span class="skolem">t</span> <span class="main">+</span> <span class="skolem">k</span> <span class="main">*</span> output_speed"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>9<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="main">(</span><span class="operator">metis</span> add_mult_distrib mult_le_mono1<span class="main">)</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lcp_dist <span class="main">(</span><span class="skolem">v1</span> <span class="main">@</span> <span class="skolem">w1</span><span class="main">)</span> <span class="main">(</span><span class="skolem">v2</span> <span class="main">@</span> <span class="skolem">w2</span><span class="main">)</span> <span class="main">≤</span> <span class="skolem">t</span> <span class="main">+</span> <span class="skolem">k</span> <span class="main">*</span> output_speed"</span></span> <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"bvT"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> bvT_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> bv'_bounded<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"bvT'"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">t</span><span class="main">.</span> bounded <span class="bound">t</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> bv'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span><span class="bound">q1</span> <span class="bound">q2</span> <span class="bound">f1</span> <span class="bound">f2</span> <span class="bound">a</span> <span class="bound">b1</span> <span class="bound">b2</span> <span class="bound">u</span> <span class="bound">v1</span> <span class="bound">v2</span> <span class="bound">w1</span> <span class="bound">w2</span><span class="main">.</span>
    <span class="bound">q1</span> <span class="main">∈</span> <span class="free">Q</span> <span class="main">⟹</span> <span class="bound">q2</span> <span class="main">∈</span> <span class="free">Q</span> <span class="main">⟹</span> <span class="free">accept</span> <span class="bound">f1</span> <span class="main">⟹</span> <span class="free">accept</span> <span class="bound">f2</span> <span class="main">⟹</span>
    <span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="bound">a</span><span class="main">,</span> <span class="bound">u</span> <span class="main">@</span> <span class="bound">v1</span><span class="main">)</span> <span class="bound">q1</span> <span class="main">⟹</span> <span class="bound">q1</span> <span class="main">↝</span><span class="main">(</span><span class="bound">b1</span><span class="main">,</span> <span class="bound">w1</span><span class="main">)</span> <span class="bound">f1</span> <span class="main">⟹</span>
    <span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="bound">a</span><span class="main">,</span> <span class="bound">u</span> <span class="main">@</span> <span class="bound">v2</span><span class="main">)</span> <span class="bound">q2</span> <span class="main">⟹</span> <span class="bound">q2</span> <span class="main">↝</span><span class="main">(</span><span class="bound">b2</span><span class="main">,</span> <span class="bound">w2</span><span class="main">)</span> <span class="bound">f2</span> <span class="main">⟹</span> lcp_dist <span class="bound">v1</span> <span class="bound">v2</span> <span class="main">≤</span> <span class="skolem">t</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms
    <span class="keyword1"><span class="command">unfolding</span></span> bvT'_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">q</span> <span class="skolem">q'</span> <span class="skolem">u</span> <span class="skolem">v</span> <span class="skolem">v'</span>
    <span class="keyword3"><span class="command">assume</span></span> prems<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">u</span><span class="main">,</span> <span class="skolem">v</span> <span class="main">@</span> <span class="skolem">v'</span><span class="main">)</span> <span class="skolem">q</span>"</span></span> <span class="quoted"><span class="quoted">"active <span class="skolem">q</span> <span class="main">[]</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">init</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">u</span><span class="main">,</span> <span class="skolem">v</span><span class="main">)</span> <span class="skolem">q'</span>"</span></span> <span class="quoted"><span class="quoted">"active <span class="skolem">q'</span> <span class="skolem">v'</span>"</span></span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="skolem"><span class="skolem">as</span></span> <span class="skolem"><span class="skolem">bs</span></span> <span class="keyword2"><span class="keyword">where</span></span> tail<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">as</span><span class="main">,</span> <span class="skolem">bs</span><span class="main">)</span> <span class="skolem">r</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">accept</span> <span class="skolem">r</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> prems<span class="main">(</span>2<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> active_def<span class="main">)</span>
    <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r'</span></span> <span class="skolem"><span class="skolem">as'</span></span> <span class="skolem"><span class="skolem">bs'</span></span> <span class="keyword2"><span class="keyword">where</span></span> tail'<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">q'</span> <span class="main">↝</span><span class="main">(</span><span class="skolem">as'</span><span class="main">,</span> <span class="skolem">v'</span> <span class="main">@</span> <span class="skolem">bs'</span><span class="main">)</span> <span class="skolem">r'</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">accept</span> <span class="skolem">r'</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> prems<span class="main">(</span>4<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> active_def<span class="main">)</span>
    <span class="keyword1"><span class="command">note</span></span> q_Q <span class="main">=</span> comp_closed<span class="main">[</span><span class="operator">OF</span> prems<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> init_in_Q<span class="main">]</span>
    <span class="keyword1"><span class="command">note</span></span> q'_Q <span class="main">=</span> comp_closed<span class="main">[</span><span class="operator">OF</span> prems<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> init_in_Q<span class="main">]</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"lcp_dist <span class="main">(</span><span class="skolem">v</span> <span class="main">@</span> <span class="skolem">v'</span><span class="main">)</span> <span class="skolem">v</span> <span class="main">=</span> lcp_dist <span class="main">(</span><span class="skolem">v</span> <span class="main">@</span> <span class="skolem">v'</span><span class="main">)</span> <span class="main">(</span><span class="skolem">v</span> <span class="main">@</span> <span class="main">[]</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> length <span class="skolem">v'</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> lcp_dist_same_pref
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"length <span class="skolem">v'</span> <span class="main">≤</span> <span class="skolem">t</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> bv'<span class="main">[</span><span class="operator">OF</span> q_Q q'_Q tail<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> tail'<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> _ tail<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> _ tail'<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="skolem">u</span></span> <span class="quoted"><span class="quoted">"<span class="main">[]</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">v</span> <span class="main">@</span> <span class="skolem">v'</span>"</span></span> <span class="quoted"><span class="skolem">v</span></span><span class="main">]</span>
        prems<span class="main">(</span>1<span class="main">,</span>3<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> bounded_def<span class="main">)</span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword2"><span class="keyword">end</span></span></pre>
</body>

</html>